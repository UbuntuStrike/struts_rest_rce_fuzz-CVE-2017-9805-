#!/usr/bin/env python3
# coding=utf-8
# *****************************************************
# Struts CVE-2017-9805 checker
# @NO53LF
#*****************************************************
import requests
import sys
import urllib
import colorama
from colorama import Fore, Style

print(Fore.WHITE + "A script to Auto-fuzz for CVE-2017-9805")
print(Fore.YELLOW + "Potentially Vulnerable ULI's will be saved in a text file 'CVE-2017-9805.txt' in the directory this script was run")
target = "http://" + input(Fore.GREEN + "enter hostname or IP. ex: example.com, 192.168.1.123:\n" + Fore.WHITE)
versions = ['']

version21 = "-2.1."
exact_version = list(range(1,35))

for exact in exact_version:
	versions.append(version21 + str(exact))

version22 = "-2.2."
exact_version = list(range(1,35))

for exact in exact_version:
	versions.append(version22 + str(exact))

version23 = "-2.3."
exact_version = list(range(1,35))

for exact in exact_version:
	versions.append(version23 + str(exact))

version25 = "-2.5."
exact_version = list(range(1,35))

for exact in exact_version:
	versions.append(version25 + str(exact))


for version in versions:
	path = "/struts2-rest-showcase" + str(version) + "/orders/"
	response = requests.get(target+path)
	f = open("CVE-2017-9805.txt","a+")
	if response.status_code == 200:
		print(Fore.YELLOW + "+ " "The URI: '" + target + path + "'" + Fore.RED + " MAY BE VULNERABLE TO STRUTS CVE-2017-9805")
		f.write("The URI: " + target + path + " MAY BE VULNERABLE TO STRUTS CVE-2017-9805\n")
	else:
		print(Fore.YELLOW + "+ " "The URI: '" + target + path + "'" + Fore.GREEN + " Does not exist")


